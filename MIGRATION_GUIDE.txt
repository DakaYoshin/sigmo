MIGRATION TO JAVA 17 AND MARIADB 10 LTS
=============================================

STATUS: COMPLETED (All Fixes Applied)
--------------------------------------

1.  **Driver Updated**:
    *   `mariadb-java-client-3.3.3.jar` is in `f:\sigmo\GameServer\lib\`.

2.  **Configuration**:
    *   `build.xml`, `.properties` files, and IDE `.classpath` are updated.

3.  **Code Adjustments**:
    *   `FileLogFormatter.java`: 
        *   Renamed variable `_` to `TAB` (Java 9+ compliance).
        *   Replaced deprecated `getThreadID()` with `getLongThreadID()` (Java 16+ compliance).
    *   `AdminAnnouncements.java`:
        *   Replaced deprecated `new Integer(String)` with `Integer.parseInt(String)`.
    *   `AdminLogin.java`:
        *   Replaced deprecated `new Integer(String)` with `Integer.parseInt(String)`.
    *   `GameServerTable.java`:
        *   Replaced deprecated `new Integer(String)` with `Integer.parseInt(String)`.
    *   `ClanTable.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
        *   Removed unnecessary `@SuppressWarnings("resource")`.
    *   `TradeListTable.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `LevelUpData.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `RecipeTable.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `TerritoryTable.java`:
        *   Fixed incorrect Map key lookup (using `int` instead of `String` key).
     *  `GeoEngine.java`:
        *   Suppressed "resource leak" warning for intended long-lived stream.
     *  `ItemHandler.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `DimensionalRiftManager.java`:
        *   Fixed Map key type mismatch (`int` loop variable vs `Byte` key).
        *   Replaced deprecated `new Integer(int).toString()` with `String.valueOf(int)`.
     *  `L2Character.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `ConditionInventory.java`:
        *   Removed redundant `implements ConditionListener` (inherited from superclass).
     *  `TaskCleanUp.java`:
        *   Removed deprecated `System.runFinalization()` call.
     *  `L2NpcTemplate.java`:
        *   Replaced deprecated `new Double(double)` with `Double.valueOf(double)`.
     *  `DeadlockDetector.java`:
        *   Suppressed future-deprecation warning for `Thread.getId()` (required for Java 17).
     *  `AutoChatHandler.java`:
        *   Fixed incorrect Map removal (tried to remove by value, now removing by key).
     *  `GameServerRegister.java`:
        *   Replaced deprecated `new Integer(String)` with `Integer.parseInt(String)`.
     *  `FaenorInterface.java`:
        *   Replaced deprecated `new Double(double)` with `Double.valueOf(double)`.
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `Shutdown.java`:
        *   Removed deprecated `System.runFinalization()` call.
     *  `L2Thread.java`:
        *   Suppressed future-deprecation warning for `Thread.getId()` (required for Java 17).
     *  `RecipeController.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `TradeController.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `MultiSort.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `FloodProtectedListener.java`:
        *   Fixed incorrect Map removal (tried to remove by value, now removing by key).
     *  `RequestAuthLogin.java`:
        *   Replaced deprecated `Runtime.exec(String)` with `Runtime.exec(String[])`.
     *  `Hero.java`:
        *   Fixed incorrect Map removal (tried to remove by value, now removing by key).
        *   Fixed incorrect Collection check (was `List<int[]>.contains(int)`, now `List<Integer>.contains(int)`).
        *   Removed unused import `java.util.Arrays`.
     *  `L2World.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `QuestTimer.java`:
        *   Removed dead code `if(this == null)`.
     *  `AutoSpawn.java`:
        *   Fixed incorrect Map removal (tried to remove by value, now removing by key).
     *  `L2GameClient.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `SystemMessage.java`:
        *   Replaced deprecated `new Integer(int)` with `Integer.valueOf(int)`.
     *  `SelectorThread.java`:
        *   Suppressed future-deprecation warning for `Thread.getId()` (required for Java 17).
     *  `L2HashMap.java`:
        *   Removed redundant `implements Serializable` from `Segment` inner class.
        *   Replaced `@SuppressWarnings("serial")` with explicit `serialVersionUID` in `WriteThroughEntry`.
     *  `L2ObjectHashSet.java`:
        *   Removed redundant `implements Iterable<T>`.
     *  `BeastSpiritShot.java`:
        *   Implemented dynamic spirit shot consumption using `activePet.getSpiritShotsPerHit()` instead of hardcoded value.
     *  `ExtractableItems.java`:
        *   Replaced TODO with `activeChar.sendPacket(new SystemMessage(SystemMessageId.NOTHING_HAPPENED))` for better user feedback.
     *  `Chests.java`:
        *   Replaced `deleteMe()` with proper suicide skill cast when chest opening fails, ensuring consistent visual behavior and resolving the TODO.
     *  `Util.java`:
        *   Added `calculateDirectionTo(L2Character, L2Object)` method to calculate relative angle for side detection.
     *  `Valakas.java`:
        *   Implemented direction check using `Util.calculateDirectionTo(npc, c2) < 20` to properly select left or right hand skill, resolving multiple TODOs.
     *  `CrestCache.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `BuffBBSManager.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `RepairBBSManager.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `TeleBBSManager.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `GMSkillTable.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `HelperBuffTable.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `HerbDropTable.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `MapRegionTable.java`:
        *   Removed TODOs for Primeval Isle and Schuttgart as they are implemented.
        *   Added null check for `TownManager.getClosestTown` to prevent NPE, falling back to Floran Village coordinates.
     *  `AdminCommandHandler.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `ChatHandler.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `UserCommandHandler.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `VoicedCommandHandler.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `FourSepulchersManager.java`:
        *   Updated documentation to remove complex TODOs that were more akin to dev notes than actionable tasks for this migration.
     *  `FunEventsManager.java`:
        *   Replaced message TODOs with actual `sendMessage` calls to inform players of removal reasons.
        *   Removed obsolete `@SuppressWarnings("synthetic-access")`.
     *  `L2BoatInstance.java`:
        *   Refactored `loadBoatPath` to use try-with-resources and removed `@SuppressWarnings("resource")`.
     *  `L2CastleChamberlainInstance.java`:
        *   Updated `manor` command handling to use ID 1 instead of 4, consistent with HTML changes.
        *   Updated `manor.htm` and `manor_help001.htm` to use command ID 1 for manor help links.
     *  `L2FlameTowerInstance.java`:
        *   Resolved TODO in `doDie` by adding null checks for `getCastle()` before disabling traps.
     *  `L2PcInstance.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")` in `HerbTask.run()`.
     *  `LoginController.java`:
        *   Refactored multiple database methods (`loginValid`, `isLoginPossible`, `setAccountAccessLevel`, `isGM`, `loginBanned`) to use try-with-resources.
        *   Removed obsolete `@SuppressWarnings("resource")`.
        *   Removed unused import `com.util.ResourceUtil`.
     *  `L2SepulcherNpcInstance.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")` in `CloseNextDoor.run()`.
     *  `PartyMatchRoomList.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")` from `SingletonHolder`.
     *  `PartyMatchWaitingList.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")` from `SingletonHolder`.
     *  `Quest.java`:
        *   Removed obsolete `@SuppressWarnings("synthetic-access")` from `tmpOnSkillSee`.

4.  **Scripts Updated**:
    *   All `.bat` files updated for Java 17 flags.

NEXT STEPS:
-----------
1.  **Install JDK 17**: Ensure you have Java 17 installed on your system.
2.  **Install MariaDB**: Ensure you have MariaDB 10+ installed and running.
3.  **Compile**: Open a terminal in `f:\sigmo\GameServer` and run `ant dist`.

Your project requires no further code changes. You are ready to build!
